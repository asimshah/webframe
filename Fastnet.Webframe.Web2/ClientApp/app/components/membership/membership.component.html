<div class="SitePanel">
    <div class="BannerPanel">
        <webframe-page class="page-component" [pageId]="this.getPageId()"></webframe-page>
    </div>
    <div class="command-bar">
        <button (click)="goBack()">Back</button>
        <button (click)="setMode(Modes.Member)">Members</button>
        <button (click)="setMode(Modes.Group)">Groups</button>
        <div></div>
        <button *ngIf="mode === Modes.Member" (click)="onAddNewMember()">Add New Member</button>
        <button *ngIf="mode === Modes.Group">Add New Group</button>
    </div>
    <div class="membership-app-panel" [ngClass]="{hidden: groupMode}">
        <div class="left-panel">
            <div class="member-index">
                <search-input placeHolderText="Search ..." name="searchMembers" [(ngModel)]="searchText" (clearClick)="onClearSearchClick()" (searchClick)="onSearchClick()"></search-input>
                <div class="address-book">
                    <div class="address-book-tabs">
                        <button *ngFor="let item of tabs" [ngClass]="{selected: item.selected}" (click)="selectTab(item)">{{item.name}}</button>
                    </div>
                    <div class="address-book-list">
                        <div class="member-entry" *ngFor="let m of memberList" (click)="onMemberClick(m)">
                            <span>{{m.firstName}} {{m.lastName}}</span>
                            <span *ngIf="m.disabled" title="Member is disabled" class="fa fa-ban"></span>
                            <span *ngIf="!m.emailAddressConfirmed" title="Waiting for email confirmation" class="fa fa-clock-o"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="right-panel">
            <div *ngIf="member" class="webframe-form">
                <div class="caption">
                    <div>{{getMemberFullName(member)}}</div>
                </div>
                <div class="form-body">
                    <email-input label="Email Address" name="emailAddress" [(ngModel)]="member.emailAddress"></email-input>
                    <div *ngIf="member.isAdministrator === false">
                        <text-input label="First Name" name="firstName" [(ngModel)]="member.firstName" [validator]="validators.item('firstName')"></text-input>
                        <text-input label="Last Name" name="lastName" [(ngModel)]="member.lastName" [validator]="validators.item('lastName')"></text-input>
                        <text-input label="Password" name="password" [(ngModel)]="member.password"></text-input>
                        <bool-input label="Disabled" name="disabled" [(ngModel)]="member.disabled"></bool-input>
                    </div>
                    <div class="annotation no-space">
                        <span>Created: {{member.creationDateFormatted}}</span>
                        <span *ngIf="member.lastLoginDate !== null">, Last logged in: {{member.lastLoginDateFormatted}}.</span>
                        <span *ngIf="member.lastLoginDate === null">, This member has not logged in.</span>
                    </div>
                    <div class="annotation warning" *ngIf="member.emailAddressConfirmed === false">
                        <span>This email address is not confirmed. The member needs to respond to the activation email.</span>
                    </div>
                </div>
                <div class="command-buttons align-at-ends">
                    <div *ngIf="member.isAdministrator === false">
                        <button *ngIf="canShowCommand(CommandButtons.DeleteMember)" class="warning">Delete Member</button>
                        <button *ngIf="canShowCommand(CommandButtons.SendActivationEmail)" class="secondary">Send Activation Email</button>
                        <button *ngIf="canShowCommand(CommandButtons.SendPasswordReset)" class="secondary">Send Password Reset</button>
                    </div>
                    <div>
                        <button *ngIf="canShowCommand(CommandButtons.Save)" class="default">Save</button>
                        <button *ngIf="canShowCommand(CommandButtons.Cancel)" class="cancel" (click)="onCancelClick()">Cancel</button>
                    </div>
                </div>
            </div>
            <div>{{member | json}}</div>
        </div>
    </div>
    <div class="group-app-panel hidden" [ngClass]="{hidden: !groupMode}">
        <div class="left-panel"></div>
        <div class="right-panel">
            <div>This is the group app</div>
        </div>
    </div>
    <div class="group-app-panel hidden" [ngClass]="{hidden: !groupMode}">
        <div class="left-panel"></div>
        <div class="right-panel">
            <div>This is the group app</div>
        </div>
    </div>
</div>

<modal-dialog id="message-box">
    <div class="modal-overlay">
        <div class="modal-container">
            <div class="form-body">
                <div *ngIf="messageBox; else noModel">
                    <div class="caption">{{messageBox.caption}}</div>
                    <div class="message-body" [innerHTML]="messageBox.message"></div>
                </div>
                <ng-template #noModel>No message object provided - use MessageBox class and call it messageBox</ng-template>
            </div>
            <div class="command-buttons align-centrally">
                <button class="default" (click)="onCloseMessageBox()">OK</button>
            </div>
        </div>
    </div>
</modal-dialog>